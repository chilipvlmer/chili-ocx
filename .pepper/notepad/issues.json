{
  "version": "1.0.0",
  "entries": [
    {
      "timestamp": "2026-01-18T21:12:35.425Z",
      "content": "**Symlink Detection Gap**: Agents currently don't check if the working directory is a symlink before concluding \"not a git repository\". This leads to false negatives when OpenCode creates symlinked workspaces (e.g., /tmp/ocx-ghost-*). Should follow symlinks or check realpath before git checks."
    },
    {
      "timestamp": "2026-01-18T21:42:06.566Z",
      "content": "**Agent Workflow Awareness Issue**\n\nAgents (including Seed) need better awareness of when to suggest switching to other specialized agents and follow the official Pepper workflow.\n\n**The Official Workflow:**\n```\nPRD ‚Üí RFC ‚Üí Plan ‚Üí Work ‚Üí Review\nSeed ‚Üí Seed ‚Üí Sprout ‚Üí Jalape√±o ‚Üí Habanero\n```\n\n**What went wrong:**\n- After creating PRD + RFC, Seed suggested switching directly to Jalape√±o (coder)\n- Should have suggested Sprout (execution planner) first\n- Skipped the planning phase entirely\n\n**Root Cause:**\n- Agent system prompts may not emphasize the workflow strongly enough\n- Agents focus on their own role without considering the broader process\n- No explicit handoff protocol between agents\n\n**Expected Behavior:**\n- After Seed creates RFC(s), should say: \"Now switch to Sprout to create an execution plan from this RFC\"\n- After Sprout creates plan, should say: \"Now switch to Jalape√±o to implement the plan\"\n- After Jalape√±o completes work, should say: \"Now switch to Habanero to review the changes\"\n\n**Fix Needed:**\n- Update agent prompts to include workflow awareness\n- Add explicit handoff suggestions at completion of each phase\n- Consider adding workflow diagram to each agent's system prompt\n- Scoville (orchestrator) should enforce this workflow more strictly"
    },
    {
      "timestamp": "2026-01-18T21:54:08.472Z",
      "content": "**Habanero Missing Critical Review Capability: Git Read Access**\n\n**Problem**: Habanero (Reviewer) cannot access git commands to view diffs, commits, or history. This severely limits code review effectiveness.\n\n**Impact**:\n- Cannot see what actually changed (git diff)\n- Cannot verify commit messages match changes\n- Cannot check if commits are atomic and well-scoped\n- Limited to reviewing current file state, not the delta\n- Cannot check git history or blame for context\n\n**Solution Needed**:\nHabanero should have read-only git access:\n- ‚úÖ Allow: git diff, git log, git show, git status, git blame\n- ‚ùå Deny: git commit, git push, git rebase, git merge (any write operations)\n\n**Current Workaround**: \n- Delegate to Jalape√±o to run git commands\n- Ask user for git diff output\n- Review only static file state\n\n**Priority**: High - This is a core reviewer capability gap\n\n**Related**: Agent tool permissions in opencode.jsonc, Habanero AGENT.md definition"
    },
    {
      "timestamp": "2026-01-18T22:04:05.485Z",
      "content": "**Pepper Workflow State Management Issues - Critical**\n\nMultiple workflow tracking issues discovered after RFC-001 completion:\n\n**Issue 1: Plan Location Confusion**\n- plan.md at .pepper/plan.md (root)\n- .pepper/plans/ directory empty\n- Unclear if each RFC should have separate plan or one active plan\n- No archival strategy for completed plans\n\n**Issue 2: Plan-TODO Desynchronization**\n- Sprout creates detailed plan in plan.md\n- OpenCode native TODO (todowrite) exists separately\n- Not synchronized or linked\n- Unclear which is source of truth\n\n**Issue 3: Plan Progress Not Tracked**\n- After RFC-001 implementation complete, plan.md still shows:\n  - status: not-started (should be completed)\n  - All checkboxes unchecked (should be [x])\n  - No ‚Üê CURRENT marker movement\n  - Phase: [NOT STARTED] (should be [COMPLETED])\n- Jalape√±o implemented but didn't update plan\n- No agent responsible for progress tracking\n\n**Issue 4: RFC Status Not Updated**\n- RFC-001 still Status: Draft (should be Implemented/Complete)\n- Acceptance criteria not checked\n- Duplicate checklists (RFC has implementation checklist, plan.md has tasks)\n- After Habanero review, RFC should be marked complete\n\n**Root Cause**: Agents create artifacts but don't maintain state. No \"closer\" agent role.\n\n**Impact**: \n- Can't track actual progress\n- Plan becomes stale immediately\n- Multiple sources of truth conflict\n- Workflow appears broken to users\n\n**Needs**: \n- Clear state management protocol\n- Agent responsible for updating status\n- Single source of truth for tasks\n- Automated state sync or manual update process"
    },
    {
      "timestamp": "2026-01-18T22:08:12.935Z",
      "content": "**Habanero Review Process Missing RFC Compliance Check**\n\n**Issue**: Habanero's code review focuses on code quality but doesn't explicitly verify RFC acceptance criteria are met.\n\n**What Happened in RFC-001**:\n- Habanero reviewed code quality (style, errors, security, performance) ‚úì\n- BUT didn't check against RFC-001 Section 1.3 Success Criteria:\n  - [ ] 100% success rate resolving valid symlinks\n  - [ ] All edge cases handled with clear error messages\n  - [ ] Cross-platform compatibility verified\n  - [ ] Zero external dependencies beyond Node.js stdlib\n  - [ ] 100% test coverage of public API\n  - [ ] Performance: Path resolution < 10ms (99th percentile)\n\n**Expected Review Process**:\n1. Read the RFC specification\n2. Check acceptance criteria section\n3. Verify each criterion is met by the implementation\n4. Code quality review (current process)\n5. Explicitly state which criteria are met/not met in review output\n\n**Review Template Should Include**:\n```markdown\n## RFC Compliance Check\n- [x] Criterion 1: Description - Status/Evidence\n- [x] Criterion 2: Description - Status/Evidence\n- [ ] Criterion 3: Description - Blocked by X\n\n## Code Quality Review\n(current review process)\n\n## Recommendation\n- APPROVE: All criteria met\n- APPROVE WITH CONDITIONS: X criteria pending\n- REJECT: Y criteria not met\n```\n\n**Impact**: Without explicit RFC checking, implementations might pass code review but fail to meet actual requirements.\n\n**Solution**: Update Habanero's review protocol to always:\n1. Locate and read the RFC\n2. Find acceptance criteria section\n3. Verify each criterion\n4. Include RFC compliance in review output"
    },
    {
      "timestamp": "2026-01-18T22:58:24.208Z",
      "content": "OpenCode Todolist Integration: Agents have todowrite/todoread tools but don't use them consistently. Current state: RFC-003 todos still showing (stale/completed) while plan.md moved on. Problem: No clear ownership - which agent updates todos? when? Root cause: Missing workflow convention. Proposed solution: Each agent type maintains context-appropriate todos - Scoville (PRD/RFC list), Seed (RFC creation phases), Sprout/Jalape√±o (execution tasks), Habanero (review checklist). Need RFC to define todo lifecycle and agent responsibilities."
    },
    {
      "timestamp": "2026-01-18T22:59:54.837Z",
      "content": "**State Management & Todo Integration (CONSOLIDATED ISSUE)**\n\nPROBLEM: Multiple sources of truth for task tracking causing desynchronization.\n\nCURRENT STATE:\n- plan.md: Markdown checkboxes for task tracking (‚úì works but static)\n- OpenCode todolist: Native UI with todowrite/todoread tools (‚úì better UX but unused)\n- RFC acceptance criteria: Checklist in RFC files (‚úì defines done but not tracked)\n- Result: All three exist independently, none fully maintained\n\nSPECIFIC MANIFESTATIONS:\n1. Plan-TODO Desync: Sprout creates plan.md, Jalape√±o uses todowrite once, then both go stale\n2. Stale Todos: RFC-003 todos still showing \"completed\" while plan.md moved to \"no active plan\"\n3. Progress Invisible: Can't see PRD completion (3/5 RFCs done = 60%?) without manual counting\n4. No Ownership: Unclear which agent updates what, when\n\nROOT CAUSE: Missing workflow conventions for state management + no context-aware todo strategy\n\nPROPOSED SOLUTION:\n1. Context-Aware Todos: Different agent contexts show different granularity\n   - Scoville: PRD-level (RFC-001 ‚úì, RFC-002 ‚úì, RFC-003 ‚úì, RFC-004 ‚è≥, RFC-005 ‚è≥)\n   - Seed: RFC creation phases (Problem ‚úì, Solution ‚è≥, Criteria ‚è≥)\n   - Sprout/Jalape√±o: Execution plan tasks (current task-level detail)\n   - Habanero: Review checklist from RFC\n\n2. Single Source of Truth: Use OpenCode todos as primary, derive plan.md from it (or vice versa)\n\n3. Lifecycle Protocol: Define who creates/updates/clears todos at each workflow stage\n   - Sprout: Creates execution todos from plan\n   - Jalape√±o: Updates progress during implementation\n   - Habanero: Marks review complete\n   - Next agent: Clears old todos, writes new context-appropriate ones\n\n4. Ownership: Each agent responsible for maintaining their context's todos\n\nIMPLEMENTATION: Needs RFC to define todo conventions + update agent prompts with todo responsibilities\n\nPRIORITY: Medium-High (improves UX significantly but workarounds exist)"
    },
    {
      "timestamp": "2026-01-19T19:17:42.149Z",
      "content": "**Seed Cannot Save PRDs/RFCs Directly**\n\n**Problem**: After Seed completes PRD/RFC creation through interactive Q&A, it cannot save the document itself and must tell user to switch to Jalape√±o.\n\n**Impact**:\n- Breaks workflow continuity (unnecessary agent switch)\n- Poor UX (Seed does all the work, Jalape√±o just writes file)\n- Violates \"agent completes their primary task\" principle\n- Adds friction to the spec creation process\n\n**Root Cause**: Seed has `write: deny` permission in opencode.jsonc\n\n**Proposed Solution**:\nUpdate Seed's permissions in `opencode.jsonc`:\n```json\n{\n  \"agent\": \"seed-prd-rfc\",\n  \"permissions\": {\n    \"read\": \"allow\",\n    \"write\": {\n      \"allow\": [\".pepper/specs/**\"]  // Allow writing to specs directory only\n    },\n    \"edit\": \"deny\",\n    \"bash\": \"deny\",\n    \"delegate\": \"deny\"\n  }\n}\n```\n\n**Benefits**:\n- Natural workflow: Seed creates spec ‚Üí Seed saves spec ‚Üí User switches to Sprout\n- Clear boundaries: Seed can ONLY write to `.pepper/specs/`, not implementation code\n- Better UX: No unnecessary context switching\n- Consistent with Sprout (who can write to `.pepper/plan.md`)\n\n**Implementation**: Update opencode.jsonc + test Seed can save PRD/RFC files\n\n**Priority**: Medium-High (improves UX significantly but workaround exists)\n\n**Related**: Could be bundled with RFC-003 (agent improvements) or separate RFC"
    },
    {
      "timestamp": "2026-01-19T19:20:44.495Z",
      "content": "**Sprout Cannot Write Execution Plans Directly**\n\n**Problem**: After Sprout creates execution plan through analysis of RFC, it cannot save the plan.md file itself and must tell user to switch to Jalape√±o.\n\n**Impact**:\n- Same issue as Seed (breaks workflow continuity)\n- Sprout does all the planning work, Jalape√±o just writes file\n- Unnecessary agent switch for mechanical file writing\n\n**Root Cause**: Sprout has no write or bash tools available\n\n**Proposed Solution**:\nUpdate Sprout's available tools to include write access to `.pepper/plan.md`:\n- Allow writing to `.pepper/plan.md` (active plan)\n- Allow writing to `.pepper/plans/*.md` (archived plans)\n- No other write permissions needed\n\n**Benefits**:\n- Natural workflow: Sprout creates plan ‚Üí Sprout saves plan ‚Üí User switches to Jalape√±o\n- Consistent with desired pattern: agent completes their primary task\n- Similar to Seed's needed permission for `.pepper/specs/`\n\n**Implementation**: Add write tool with `.pepper/plan.md` and `.pepper/plans/` restrictions\n\n**Priority**: Medium-High (same as Seed write permissions issue)\n\n**Related**: Seed write permissions issue, RFC-003 workflow improvements"
    },
    {
      "timestamp": "2026-01-19T19:30:53.266Z",
      "content": "**Git Workflow Not Clearly Defined**\n\n**Observation**: User asked about official git workflow approach. Investigation reveals:\n\n**Current State**:\n- CONTRIBUTING.md mentions creating branches (`git checkout -b add-my-component`)\n- RFC-003 execution plan includes \"Create feature branch\" as first step\n- Actual practice: Work done on `dev-symlink-detection` branch (no feature branches created)\n- Previous RFCs (001, 002) implemented directly on dev branch without separate feature branches\n- Multiple dev branches exist: `dev`, `dev-symlink-detection`, `meta-improvements`\n\n**Inconsistency**:\n- RFC plans say \"create feature branch\"\n- Actual workflow: commit directly to dev branches\n- No documented workflow in ARCHITECTURE.md or main docs\n\n**Questions**:\n1. Should each RFC get a feature branch (`feat/rfc-NNN-name`)?\n2. Or work directly on dev branch and merge to main when ready?\n3. When/how do we merge dev branches to main?\n4. What's the PR/review process?\n5. Are dev branches personal or shared?\n\n**Impact**:\n- Confusing for contributors\n- Plans include unnecessary steps if not actually needed\n- Unclear when to create branches vs commit directly\n\n**Proposed Solution**:\nDocument official git workflow in ARCHITECTURE.md or CONTRIBUTING.md:\n- Branch naming conventions\n- When to create branches vs commit directly\n- Merge strategy (squash, rebase, merge commits)\n- PR process (if any)\n- Dev branch vs feature branch usage\n\n**Recommendation for Now**:\nSince previous RFCs worked directly on dev branch without feature branches, and we're already on `dev-symlink-detection`, let's:\n1. Skip \"create feature branch\" step in plan\n2. Continue working on current `dev-symlink-detection` branch\n3. Document actual workflow for future\n\n**Priority**: Medium (workflow works but isn't documented)\n\n**Related**: RFC-003 execution plan, CONTRIBUTING.md"
    },
    {
      "timestamp": "2026-01-19T20:16:42.218Z",
      "content": "**BLOCKER: dev-symlink-detection Branch Not Tested End-to-End**\n\n**Status**: Testing incomplete - cannot recommend merge yet\n\n**Problem**: Comprehensive testing was performed on code functionality but the critical end-to-end installation and launch test was NOT performed.\n\n**What's Untested**:\n1. Installing pepper-harness from the dev branch's local registry\n2. Launching Ghost OpenCode with the new components\n3. Verifying tools (/pepper-init, /pepper-status) work in live session\n4. Confirming agent prompts load and display correctly\n5. Testing workflow handoffs work in actual OpenCode UI\n\n**Risk**:\n- HIGH: Build could be broken at runtime\n- HIGH: Registry could be malformed\n- MEDIUM: Component metadata issues\n- MEDIUM: Agent prompts might not load correctly\n\n**Current Test Status**:\n- Phase 1-6: ‚úÖ COMPLETE (18/18 tests passed)\n- Phase 7: ‚ö†Ô∏è INCOMPLETE (documentation done, but E2E test missing)\n\n**Required Action Before Merge**:\n1. Add Phase 8: End-to-End Installation & Launch Test to testing plan\n2. Execute E2E test following the protocol in learnings\n3. Fix any issues discovered\n4. Update test report with E2E results\n5. ONLY THEN recommend merge\n\n**Current Recommendation**: üî¥ **NOT READY TO MERGE** (changed from previous ‚úÖ)\n\n**Priority**: P0 - BLOCKER\n\n**Created**: 2026-01-19 during testing review"
    },
    {
      "timestamp": "2026-01-19T20:29:23.821Z",
      "content": "**BLOCKER: Ghost Profiles Don't Provide Component Isolation (2026-01-19)**\n\n**Severity**: CRITICAL - Blocks E2E testing\n\n**Problem**: Creating a new Ghost profile does NOT create an isolated component environment.\n\n**Evidence from Phase 8 Testing**:\n1. Created fresh profile \"test-e2e-1768854495\"\n2. Ran `ocx ghost list`\n3. Result: 20 components already installed from production registry (chili-ocx/*)\n4. Tried `ocx ghost add dev-test/pepper-plugin`\n5. Error: \"File conflict: .opencode/plugin/pepper-plugin.js already exists\"\n\n**Root Cause**: All profiles appear to share the same `.opencode/` installation directory.\n\n**Impact**:\n- CANNOT test clean installation of dev branch\n- CANNOT verify component installation works\n- CANNOT test for installation conflicts\n- E2E testing fundamentally blocked\n\n**What We Need**:\n- Either: Way to create truly isolated profile with separate workspace\n- Or: Way to uninstall/remove components before testing\n- Or: Way to specify alternate .opencode directory per profile\n\n**Current Workaround Attempts**:\n- Profile creation: ‚ùå Components persist\n- Profile switching: ‚ùå Same components visible\n- No `ocx ghost remove` command exists\n\n**Recommendation**:\n1. Investigate Ghost profile architecture (where are components stored?)\n2. Find way to clear components or create isolated workspace\n3. OR: Document that E2E testing requires manual .opencode cleanup\n4. OR: Test in completely separate environment (Docker, VM, fresh user account)\n\n**Priority**: P0 - BLOCKER for E2E testing methodology\n\n**Status**: Investigating"
    }
  ]
}